<!DOCTYPE html>
<html>
    <head>private</head>
    <body>
        <h1>Authenticated!</h1>
        <p>Welcome</p>
        <button id="logout"><a href="http://127.0.0.1:8000/">Logout</a></button>

        <!-- Testing -->

        <button id="buybook1">Buy Book 1</button>
        <button id="cancelorder">Cancel Order</button>
        
        <div id="results"></div>
       

     <script>
         const book1 = document.getElementById("buybook1");
         const del = document.getElementById("cancelorder");

         book1.addEventListener("click", BuyBook1);
         del.addEventListener("click", CancelOrder);

         async function BuyBook1() {
        const res = await fetch('/api/user/private/addentry', {
             method: 'POST',
             body: JSON.stringify({
                       bookid: 1,
                       bookname: "book1",
                       isbn: "isbn1",
                       quantity: 4,
                       price: 780,
                    }),
                    headers: {
                        'Content-Type':'application/json'
                    }
       })
        const data = await res.json();
        console.log(data);
    }
    
     async function CancelOrder(){
        const res = await fetch('/api/user/private/deleteentry', {
             method: 'POST',
             body: JSON.stringify({
                       bookid: 1,
                       bookname: "book1",
                       isbn: "isbn1",
                       time: "0",
                       quantity: 4,
                       price: 780,
                    }),
                    headers: {
                        'Content-Type':'application/json'
                    }
       })
        const data = await res.json();
        console.log(data.length);
        // var bookid = document.getElementById("bookid")
        // var bookname = document.getElementById("bookname")
        // var isbn = document.getElementById("isbn")
        // var quantity = document.getElementById("quantity")
        // var price = document.getElementById("price")
        //bookid.innerHTML = data[0].Bookid
        for(var i=0; i<data.length; i++){

           //create elements
            var result = document.createElement('result')
            var bookid = document.createElement("bookid")
            var bookname = document.createElement("bookname")
            var isbn = document.createElement("isbn")
            var quantity = document.createElement("quantity")
            var price = document.createElement("price")
            var placeorder = document.createElement("button")
           
          //fill details
            bookid.innerHTML = data[i].Bookid
            bookname.innerHTML = data[i].Bookname
            isbn.innerHTML = data[i].Isbn
            quantity.innerHTML = data[i].Quantity
            price.innerHTML = data[i].Price
            placeorder.type = "button"
            placeorder.value = "Button "+i
            placeorder.textContent = "Buy Now"
         //append
            result.appendChild(bookid)
            result.appendChild(bookname)
            result.appendChild(isbn)
            result.appendChild(quantity)
            result.appendChild(price)
            result.appendChild(placeorder)

            result.id = "result " + i
           
            document.getElementById("results").appendChild(result)

        }
        //var list = [];
        //list = JSON.parse(data);
        /*for(const obj in data){
            console.log(obj.Bookid)
            console.log(obj.Bookname)
            console.log(obj.Isbn)
            console.log(obj.Quantity)
            console.log(obj.Price)
            console.log("\n")
        }*/
     }
        
     </script>  
    </body>

</html>